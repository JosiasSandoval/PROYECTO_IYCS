<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Pago Seguro</title>
  <link rel="stylesheet" href="/static/css/pago.css" />
</head>

<body 
    data-rol="{{ session.get('rol_sistema', '') }}"
    data-id="{{ session.get('idUsuario', '') }}"
    data-parroquia="{{ session.get('idParroquia', '') }}"
>

  <!-- HEADER DIN√ÅMICO -->
  <div id="header-placeholder"></div>

  <main class="grid">

    <!-- BARRA LATERAL -->
    <div id="barra_lateral-placeholder"></div>

    <!-- CONTENEDOR PRINCIPAL -->
    <div class="contenedor-principal">
      
      <h2 class="titulo-pagina">Detalles del Pago Consolidado</h2>

      <!-- GRID DE 3 COLUMNAS -->
      <div class="contenedor-pago-consolidado">

        <!-- ============================ -->
        <!-- COLUMNA 1: RESERVAS -->
        <!-- ============================ -->
        <div class="reservas-columna">
          
          <h3 class="titulo-columna">1. Selecciona Reservas Pendientes</h3>
          <p class="instruccion-reserva">Marca las reservas que deseas pagar en esta transacci√≥n.</p>

          <div id="filtro-container" style="display: none;">
            <label for="filtro-reservas">Buscar por beneficiario:</label>
            <input type="text" id="filtro-reservas" placeholder="Ingresa nombre de la persona..." />
          </div>

          <div class="tabla-reservas-container" id="reservas-lista">

            <!-- FILAS DIN√ÅMICAS DE RESERVAS DE EJEMPLO -->
            <div class="reserva-row" data-id="R001" data-monto="150.00">
              <input type="checkbox" class="reserva-checkbox" id="check-R001">
              <label for="check-R001">Reserva #1 - Servicio A (15/07/2024)</label>
              <span class="reserva-monto">S/ 150.00</span>
            </div>

            <div class="reserva-row" data-id="R002" data-monto="80.50">
              <input type="checkbox" class="reserva-checkbox" id="check-R002">
              <label for="check-R002">Reserva #2 - Servicio B (20/07/2024)</label>
              <span class="reserva-monto">S/ 80.50</span>
            </div>

            <div class="reserva-row" data-id="R003" data-monto="55.00">
              <input type="checkbox" class="reserva-checkbox" id="check-R003">
              <label for="check-R003">Reserva #3 - Servicio C (01/08/2024)</label>
              <span class="reserva-monto">S/ 55.00</span>
            </div>
            <!-- FIN FILAS -->
          </div>

          <div class="total-seleccionado">
            <strong class="label-total-sel">Total Seleccionado:</strong>
            <span id="total-reservas" class="monto-total-sel">S/ 0.00</span>
          </div>

        </div>
        <!-- FIN COLUMNA 1 -->

        
        <!-- ============================ -->
        <!-- COLUMNA 2: M√âTODOS + FORMULARIO -->
        <!-- ============================ -->
        <div class="formulario-columna">

          <h3 class="titulo-columna">2. Selecciona M√©todo de Pago</h3>

          <!-- M√âTODOS DE PAGO -->
                    <div class="metodos-pago" id="metodos-container">
                        
                        <button class="metodo-card active" data-metodo="tarjeta">
                            <span class="icono-metodo">üí≥</span>
                            <span class="nombre-metodo">Tarjeta de Cr√©dito / D√©bito</span>
                        </button>

                        <button class="metodo-card" data-metodo="yape">
                            <span class="icono-metodo">üì±</span>
                            <span class="nombre-metodo">Yape</span>
                        </button>

                        <button class="metodo-card" data-metodo="plin">
                            <span class="icono-metodo">üè¶</span>
                            <span class="nombre-metodo">Plin</span>
                        </button>

                        <button class="metodo-card" data-metodo="efectivo">
                            <span class="icono-metodo">üíµ</span>
                            <span class="nombre-metodo">Efectivo en Oficina</span>
                        </button>

                    </div>

                      <!-- FORMULARIO GENERAL -->
            <form class="formulario-pago" id="form-pago">
                <input type="hidden" id="idReservasSeleccionadas" name="idReservasSeleccionadas">
                
                <!-- Este div es el contenedor CR√çTICO para el scroll interno.
                    Debe envolver todos los form-section pero NO al bot√≥n de submit. -->
                <div class="form-content-area">

                    <!-- ============ TARJETA ============ -->
                    <div class="form-section active" data-metodo="tarjeta" id="section-tarjeta">
                        <h4 class="subtitulo-seccion">Datos de la Tarjeta</h4>

                        <div class="tarjeta-visual">
                            <div class="tarjeta-chip"></div>
                            <div class="tarjeta-numero" id="card-display">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢ ‚Ä¢‚Ä¢‚Ä¢‚Ä¢</div>

                            <div class="tarjeta-info">
                                <div>
                                    <div class="small-text">TITULAR</div>
                                    <div id="name-display">NOMBRE APELLIDO</div>
                                </div>

                                <div>
                                    <div class="small-text">VENCE</div>
                                    <div id="exp-display">MM/AA</div>
                                </div>
                            </div>
                        </div>

                        <label for="numero">N√∫mero de tarjeta *</label>
                        <input type="text" id="numero" placeholder="1234 5678 9012 3456" maxlength="19" required>

                        <label for="nombre-titular">Nombre del titular *</label>
                        <input type="text" id="nombre-titular" placeholder="Tal como aparece en la tarjeta" required>

                        <div class="fila">
                            <div>
                                <label for="exp">Fecha de expiraci√≥n *</label>
                                <input type="text" id="exp" placeholder="MM/AA" maxlength="5" required>
                            </div>

                            <div>
                                <label for="cvv">CVV *</label>
                                <input type="password" id="cvv" placeholder="123" maxlength="4" required>
                            </div>
                        </div>

                    </div>

                    <!-- ============ YAPE ============ -->
                    <div class="form-section" data-metodo="yape" id="section-yape">
                        <h4 class="subtitulo-seccion">Pago con Yape</h4>

                        <div class="info-metodo">
                            <p>Escanea el c√≥digo QR desde tu app de Yape</p>
                            <div class="qr-placeholder">
                                <p class="qr-texto">C√≥digo QR de pago</p>
                            </div>
                        </div>

                        <div class="dato-item">
                            <span class="dato-label">N√∫mero destino:</span>
                            <span class="dato-valor">999 888 777</span>
                        </div>

                        <label for="yape-codigo">C√≥digo de operaci√≥n *</label>
                        <input type="text" id="yape-codigo" placeholder="Ingresa el c√≥digo de 8 d√≠gitos">
                    </div>

                    <!-- ============ PLIN ============ -->

                    <div class="form-section" data-metodo="transferencia" id="section-plin">
                        <h4 class="subtitulo-seccion">Pago con Plin</h4>

                        <div class="info-metodo">
                            <p>Escanea el c√≥digo QR desde tu app de Yape</p>
                            <div class="qr-placeholder">
                                <p class="qr-texto">C√≥digo QR de pago</p>
                            </div>
                        </div>

                        <div class="dato-item">
                            <span class="dato-label">N√∫mero destino:</span>
                            <span class="dato-valor">999 888 777</span>
                        </div>

                        <label for="plin-codigo">C√≥digo de operaci√≥n *</label>
                        <input type="text" id="plin-codigo" placeholder="Ingresa el c√≥digo de transacci√≥n" required>
                    </div>

                    <!-- ============ EFECTIVO ============ -->
                    <div class="form-section" data-metodo="efectivo" id="section-efectivo">
                        <h4 class="subtitulo-seccion">Pago en Efectivo</h4>

                        <div class="info-metodo">
                            <p>Realiza el pago en nuestras oficinas o al momento del servicio</p>

                            <div class="info-efectivo">
                                <p><strong>Direcci√≥n:</strong> Av. Principal 123, Chiclayo</p>
                          <p><strong>Horario:</strong> Lun-Vie 9:00 AM - 6:00 PM</p>
                                <p class="nota-pago">El pago debe realizarse antes de la fecha del servicio</p>
                            </div>
                        </div>

                        <label for="efectivo-nombre">Nombre completo *</label>
                        <input type="text" id="efectivo-nombre" placeholder="Nombre de quien realizar√° el pago" required>

                        <label for="efectivo-dni">DNI *</label>
                        <input type="text" id="efectivo-dni" placeholder="N√∫mero de DNI" maxlength="8" required>
                    </div>
                    
                </div> <!-- Cierre de .form-content-area -->

                <button type="submit" class="btn-pagar btn-tarjeta" data-metodo="tarjeta" id="btn-submit">Procesar Pago</button>

            </form>

        </div>
        <!-- FIN COLUMNA 2 -->


        <!-- ============================ -->
        <!-- COLUMNA 3: RESUMEN -->
        <!-- ============================ -->
        <div class="resumen-columna">

          <div class="resumen-pago">

            <h3 class="titulo-columna">3. Resumen del Pedido</h3>

            <div class="detalle-linea">
              <span class="label">Reservas Seleccionadas:</span>
              <span class="valor" id="reservas-cont">0</span>
            </div>

            <div id="resumen-contenido">
              <div class="detalle-linea">
                <span class="label">Subtotal de Servicios:</span>
                <span class="valor" id="subtotal-servicios">S/ 0.00</span>
              </div>

              <hr class="divisor-resumen">

              <div class="total-linea">
                <strong class="label-total">Total a Pagar:</strong>
                <span class="total-amount" id="total">S/ 0.00</span>
              </div>
            </div>

            <div class="seguridad-badge">
              <span class="icono-seguridad">üîí</span>
              <div>
                <strong>Pago 100% seguro</strong>
                <div class="texto-seguridad">Tus datos est√°n protegidos con encriptaci√≥n SSL</div>
              </div>
            </div>
          </div>

        </div>
        <!-- FIN COLUMNA 3 -->

      </div>
      <!-- FIN GRID 3 COLUMNAS -->

    </div>

  </main>

  <!-- SCRIPTS -->
  <script src="/static/js/header.js"></script>
  <script src="/static/js/barra_lateral.js"></script>
  <script src="/static/js/pago.js"></script>

</body>
</html>
